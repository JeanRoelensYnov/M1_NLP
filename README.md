# Movie Genre classification & Plot summarizer
Hello there and welcome, this repository is a school project which involve basic understanding of ML and DL. There's a lot of place to improve but feel free to play with it.

## Context
The goal of this school project was to create 4 models, 2 machine learning and 2 deep learning. With one of each for classification and the two others for summarization (or key topics identification).

I put much work on the classification side than on the summarization/key topics identification.

## Disclaimer
For this project I tried to use the maximum of open documentation and tried to list as much of them as I could in [Source](#source). I probably forgot some, I also used ChatGPT, most of the time more to see big topic and then search myself.

There's one model that I can't classify (in my opinion) as a "ML Model" it's the ML Summarizer if you look a bit in the code you'll see that it's not trained it just perform Summarization on the go.

I made this project on a windows based computer so you may have to search yourself if you want to run it on Linux or Mac.

## Pre-requisite
For this project to work you'll need : 
- Your computer (surprising I know)
- Python 
- [Anaconda](https://www.anaconda.com/download) or [Miniconda](https://www.anaconda.com/docs/getting-started/miniconda/install#quickstart-install-instructions)
- [git](https://git-scm.com/downloads)

And that's all
## Setup
The only setup needed is to create the virtual environment provided in the `env.yml` file. But first clone the repository.

```git
git clone https://github.com/JeanRoelensYnov/M1_NLP.git
```

Then open a terminal in the repository (IDE, cmd, powershell..)
And create your virtual environment:

```bash
conda env create -f env.yml
```

You may have to wait a bit for the installation to finish.
Once the installation is done you're good to go ! 

---
> Wait wait, and how do I get rid of my environment after ?

Esay ! Just use this command :
```bash
conda remove -n nlp-project --all 
```
---

## Run the app

Curiously to run the app you won't have to use a **python** command but streamlit, streamlit is a python framework for AI/ML apps.

So, still with your terminal we'll activate the conda environment done previously, and then run streamlit.

```bash
conda activate nlp-project
$env:PYTHONPATH="."
streamlit run .\app\app.py
```
Then your browser should open and you will have access to the interface, enjoy !

## "I want to tweaks the ML classifier"
Main file :
[`generate_ml_model.py`](./models/generate_ml_model.py)

Train/Test data :
- [`train_preprocessed.parquet`](./data/preprocessed/train_preprocessed.parquet)
- [`test_preprocessed.parquet`](./data//preprocessed/test_preprocessed.parquet)

File generated by the script :
- [`ml_model.pkl`](./models/ml_model.pkl)

If you want to tweak this model just modify `generate_ml_model.py`

## "I want to tweaks the DL classifier"
Main file :
[`generate_dl_model.py`](./models/generate_dl_model.py)

Train/Test data :
- [`train_preprocessed.parquet`](./data/preprocessed/train_preprocessed.parquet)
- [`test_preprocessed.parquet`](./data//preprocessed/test_preprocessed.parquet)

File generated by the script :
- [`dl_model.pkl`](./models/dl_model.pkl)
- [`word2idx.pkl`](./models/word2idx.pkl)
- [`label_encoder.pkl`](./models/label_encoder.pkl)

If you want to tweak this model just modify `generate_dl_model.py`

## "I want to tweaks the ML Summarizer"
Actually for this one it will a bit dissapointing jsut got to [`app.py`](./app/app.py) and tweaks the function **ml_summarize** (l.70-95)

## "I want to tweaks the DL Summarizer"
Main file :
[`summarizer_dl_model.py`](./models/summarizer_dl_model.py)
File generated by the script :
- [`tokenizer_input.txt`](./models/tokenizer_input.txt)
- [`movie_tokenizer.model`](./models/movie_tokenizer.model)
- `movie_summary_data.pt` (this one is not present because too large sorry)
- [`movie_summarizer_model.pt`](./models/movie_summarizer_model.pt)

The train data is directly imported in the script (main file).
If you want to tweak this model just modfy ``

## Contact
If you want to reach me to have some explaination about this project, or why I chose this or that :
jean.roelens@ynov.com

## Source

EDA :
- [Exploratory Data Analysis for Natural Language Processing: A Complete Guide to Python Tools](https://neptune.ai/blog/exploratory-data-analysis-natural-language-processing-tools) 
- [A Beginnerâ€™s Guide to Exploratory Data Analysis (EDA) on Text Data (Amazon Case Study)](https://www.analyticsvidhya.com/blog/2020/04/beginners-guide-exploratory-data-analysis-text-data/)
- [Data Preprocessing and EDA for Natural Language Processing.](https://medium.com/geekculture/data-preprocessing-and-eda-for-natural-language-processing-56e45c1df36d)
- [ðŸ“–Complete Guide to EDA on Text Data](https://www.kaggle.com/code/harshsingh2209/complete-guide-to-eda-on-text-data)
- [A Complete Exploratory Data Analysis and Visualization for Text Data: Combine Visualization and NLP to Generate Insights](https://www.kdnuggets.com/2019/05/complete-exploratory-data-analysis-visualization-text-data.html)
- [Exploratory Data Analysis of Text data Including Visualization](https://regenerativetoday.com/exploratory-data-analysis-of-text-data-including-visualization-and-sentiment-analysis/)
- [Easy ways to visualise data when using Polars](https://r-brink.medium.com/easy-ways-to-visualise-data-when-using-polars-e2756bc5dd37)
- [Spacy models](https://spacy.io/models)
- [Interactive data visualizations](https://jupyterbook.org/en/stable/interactive/interactive.html)

PREPROCESSING:
- [Enhancing NLP pipelines with SpaCy pipe](https://www.analyticsvidhya.com/blog/2023/08/nlp-pipelines-with-spacy/)
- [English language contractions in python](https://stackoverflow.com/questions/19790188/expanding-english-language-contractions-in-python)

VECTORIZER:
- [TdidfVectorizer for text feature extraction](https://medium.com/@masudowolabi/how-to-use-sklearns-tfidfvectorizer-for-text-feature-extraction-in-model-testing-e1221fd274f8)
- [How to use Tfidftransformer & Tfidfvectorizer ](https://kavita-ganesan.com/tfidftransformer-tfidfvectorizer-usage-differences/)
- [How to encode text data](https://machinelearningmastery.com/prepare-text-data-machine-learning-scikit-learn/)
- [How to reuse TF-IDF vectorizer](https://stackoverflow.com/questions/29788047/keep-tfidf-result-for-predicting-new-content)

EMBEDDINGS:
- [Popular Word Embedding Techniques](https://dataaspirant.com/word-embedding-techniques-nlp/)
- [A dummy's guide to word2vec](https://medium.com/@manansuri/a-dummys-guide-to-word2vec-456444f3c673)
- [Python word embedding using word2vec](https://www.geeksforgeeks.org/python-word-embedding-using-word2vec/)
- [Numpy version breaks spaCy](https://github.com/explosion/spaCy/issues/13528)

MACHINE LEARNING:
- [Machine Learning Model Evaluation](https://www.geeksforgeeks.org/machine-learning/machine-learning-model-evaluation/)
- [How to save trained model in Machine Learning](https://neptune.ai/blog/saving-trained-model-in-python)
- [Gridsearch documentation](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html)
- [Using Machine Learning to Identify Movie Genre](https://conferences.computer.org/ictapub/pdfs/ITCA2020-6EIiKprXTS23UiQ2usLpR0/114100a001/114100a001.pdf)

DEEP LEARNING:
- [Predicting Movie Genres Based on Plot Summaries](https://www.researchgate.net/publication/322517980_Predicting_Movie_Genres_Based_on_Plot_Summaries)
- [GloVe](https://nlp.stanford.edu/projects/glove/)
- [Alternative to Gensim word2vec](https://www.quora.com/Are-there-any-more-modern-alternatives-to-word2vec)
- [Word embeddings with pytorch](https://www.pythonprog.com/word-embeddings/)
- [Google SentencePiece](https://github.com/google/sentencepiece)
- [seq2seq explained](https://medium.com/analytics-vidhya/encoder-decoder-seq2seq-models-clearly-explained-c34186fbf49b)
- [SentencePiece training in python](https://github.com/google/sentencepiece/blob/master/python/README.md)

SUMMARIZATION:
- [Top 5 Summarizer](https://www.turing.com/kb/5-powerful-text-summarization-techniques-in-python)


MISC :
- [_\_file__ does not exist in Jupyter Notebook](https://stackoverflow.com/questions/39125532/file-does-not-exist-in-jupyter-notebook)
- [Remove punctuations with polars](https://stackoverflow.com/questions/71468399/python-polars-regex-remove-non-english-keep-numbers-punctuations-and-emojis)
- [Best way to strip punctuation from a string](https://stackoverflow.com/questions/265960/best-way-to-strip-punctuation-from-a-string)
- [Stemming vs lemmatization](https://www.analyticsvidhya.com/blog/2022/06/stemming-vs-lemmatization-in-nlp-must-know-differences/)
- [Difference between Apache Parquet and Apache Arrow](https://medium.com/@rramiz.rraza/what-is-apache-arrow-and-how-it-differs-from-apache-parquet-c2b17ef4b00)
- [TQDM documentation](https://tqdm.github.io/)